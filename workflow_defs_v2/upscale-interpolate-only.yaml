name: upscale-interpolate-only
display_name: "Video Upscale / Interpolate"
group: "Utilities"
description: "Batch video upscale or interpolation using switchable mode"
input_type: video
input_extensions: [.mp4, .mov, .mkv, .webm, .avi, .m4v, .mpg, .mpeg, .wmv]

template_inline:
  "1":
    class_type: LoadVideo
    inputs:
      file: example.mp4
  "2":
    class_type: GetVideoComponents
    inputs:
      video: ["1", 0]
  "3":
    class_type: ImageScaleBy
    inputs:
      image: ["2", 0]
      upscale_method: lanczos
      scale_by: 1.5
  "4":
    class_type: RIFE VFI
    inputs:
      ckpt_name: rife47.pth
      frames: ["2", 0]
      clear_cache_after_n_frames: 10
      multiplier: 2
      fast_mode: true
      ensemble: true
      scale_factor: 1.0
  "5":
    class_type: ComfySwitchNode
    inputs:
      switch: false
      on_false: ["6", 0]
      on_true: ["11", 0]
  "6":
    class_type: CreateVideo
    inputs:
      images: ["3", 0]
      audio: ["2", 1]
      fps: ["2", 2]
  "7":
    class_type: SaveVideo
    inputs:
      video: ["5", 0]
      filename_prefix: video/upscale_or_interp
      format: auto
      codec: auto
  "11":
    class_type: CreateVideo
    inputs:
      images: ["4", 0]
      audio: ["2", 1]
      fps: 48

file_bindings:
  load_video:
    nodes: ["1"]
    field: file
  output_prefix:
    nodes: ["7"]
    field: filename_prefix

parameters:
  mode_interpolate:
    label: "Mode: Interpolate"
    type: bool
    nodes: ["5"]
    field: switch
    default: false
  upscale_scale_by:
    label: "Upscale scale"
    type: float
    nodes: ["3"]
    field: scale_by
    default: 1.5
    min: 1.0
    max: 8.0
  interpolate_multiplier:
    label: "Interpolate multiplier"
    type: int
    nodes: ["4"]
    field: multiplier
    default: 2
    min: 1
    max: 8
  interpolate_fps:
    label: "Interpolate output FPS"
    type: int
    nodes: ["11"]
    field: fps
    default: 48
    min: 1
    max: 240
  output_prefix:
    label: "Output prefix"
    type: text
    default: "video/upscale_or_interp"

switch_states: {}
move_processed: false
