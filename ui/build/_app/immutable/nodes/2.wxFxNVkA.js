import{a as R,f as F,t as ba,c as ze}from"../chunks/CWu3kvEh.js";import{i as me}from"../chunks/kS6ZuW2E.js";import{w as De,d as cr,c as Kt,a as Ia,o as Pa}from"../chunks/BHLkAEcU.js";import{c as pt,f as Ta,aQ as Ma,h as le,I as st,a5 as Na,C as fr,o as e,D as dr,F as vr,G as ha,J as ot,e as at,aC as Ca,aJ as pr,au as wa,a as Ae,aR as Ie,b as Bt,aS as _r,s as mr,Z as it,a3 as Qt,aI as Xt,aT as gr,aU as br,N as U,ag as ya,aV as hr,r as La,p as Ra,aW as Rt,af as Oa,aX as wr,aY as yr,aG as kr,d as Sr,aD as Ft,aZ as Er,ax as xr,K as jr,a_ as Da,aL as qa,a$ as $r,b0 as Ar,b1 as Wa,b2 as Ir,b3 as Ba,b4 as Pr,b5 as Tr,b6 as Mr,b7 as Nr,aN as Cr,k as b,ad as Lr,w as ge,x as H,y as be,z as g,A as _,B as p,O as v,g as je,q as Y,aP as ct,b8 as Fa,b9 as ce,ba as za,bb as Rr,av as ka,bc as Or}from"../chunks/BSeel8Ej.js";import{e as D,s as W}from"../chunks/BHvyvzda.js";import{i as oe,s as St,a as He,p as ee}from"../chunks/DUrgWCwK.js";function ye(t,r){return r}function Dr(t,r,a){for(var s=[],u=r.length,n,l=r.length,d=0;d<u;d++){let L=r[d];Ra(L,()=>{if(n){if(n.pending.delete(L),n.done.add(L),n.pending.size===0){var m=t.outrogroups;zt(Xt(n.done)),m.delete(n),m.size===0&&(t.outrogroups=null)}}else l-=1},!1)}if(l===0){var i=s.length===0&&a!==null;if(i){var S=a,y=S.parentNode;kr(y),y.append(S),t.items.clear()}zt(r,!i)}else n={pending:new Set(r),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(n)}function zt(t,r=!0){for(var a=0;a<t.length;a++)Sr(t[a],r)}var Sa;function ke(t,r,a,s,u,n=null){var l=t,d=new Map,i=(r&Ma)!==0;if(i){var S=t;l=le?st(Na(S)):S.appendChild(pt())}le&&fr();var y=null,L=it(()=>{var N=a();return Qt(N)?N:N==null?[]:Xt(N)}),m,w=!0;function I(){h.fallback=y,qr(h,m,l,r,s),y!==null&&(m.length===0?(y.f&Ie)===0?La(y):(y.f^=Ie,rt(y,null,l)):Ra(y,()=>{y=null}))}var A=Ta(()=>{m=e(L);var N=m.length;let J=!1;if(le){var T=dr(l)===vr;T!==(N===0)&&(l=ha(),st(l),ot(!1),J=!0)}for(var x=new Set,O=Ae,j=mr(),C=0;C<N;C+=1){le&&at.nodeType===Ca&&at.data===pr&&(l=at,J=!0,ot(!1));var q=m[C],E=s(q,C),k=w?null:d.get(E);k?(k.v&&wa(k.v,q),k.i&&wa(k.i,C),j&&O.unskip_effect(k.e)):(k=Wr(d,w?l:Sa??(Sa=pt()),q,E,C,u,r,a),w||(k.e.f|=Ie),d.set(E,k)),x.add(E)}if(N===0&&n&&!y&&(w?y=Bt(()=>n(l)):(y=Bt(()=>n(Sa??(Sa=pt()))),y.f|=Ie)),N>x.size&&_r(),le&&N>0&&st(ha()),!w)if(j){for(const[$,Q]of d)x.has($)||O.skip_effect(Q.e);O.oncommit(I),O.ondiscard(()=>{})}else I();J&&ot(!0),e(L)}),h={effect:A,items:d,outrogroups:null,fallback:y};w=!1,le&&(l=at)}function tt(t){for(;t!==null&&(t.f&wr)===0;)t=t.next;return t}function qr(t,r,a,s,u){var k,$,Q,z,V,Z,ie,fe,re;var n=(s&yr)!==0,l=r.length,d=t.items,i=tt(t.effect.first),S,y=null,L,m=[],w=[],I,A,h,N;if(n)for(N=0;N<l;N+=1)I=r[N],A=u(I,N),h=d.get(A).e,(h.f&Ie)===0&&(($=(k=h.nodes)==null?void 0:k.a)==null||$.measure(),(L??(L=new Set)).add(h));for(N=0;N<l;N+=1){if(I=r[N],A=u(I,N),h=d.get(A).e,t.outrogroups!==null)for(const te of t.outrogroups)te.pending.delete(h),te.done.delete(h);if((h.f&Ie)!==0)if(h.f^=Ie,h===i)rt(h,null,a);else{var J=y?y.next:i;h===t.effect.last&&(t.effect.last=h.prev),h.prev&&(h.prev.next=h.next),h.next&&(h.next.prev=h.prev),Ce(t,y,h),Ce(t,h,J),rt(h,J,a),y=h,m=[],w=[],i=tt(y.next);continue}if((h.f&Rt)!==0&&(La(h),n&&((z=(Q=h.nodes)==null?void 0:Q.a)==null||z.unfix(),(L??(L=new Set)).delete(h))),h!==i){if(S!==void 0&&S.has(h)){if(m.length<w.length){var T=w[0],x;y=T.prev;var O=m[0],j=m[m.length-1];for(x=0;x<m.length;x+=1)rt(m[x],T,a);for(x=0;x<w.length;x+=1)S.delete(w[x]);Ce(t,O.prev,j.next),Ce(t,y,O),Ce(t,j,T),i=T,y=j,N-=1,m=[],w=[]}else S.delete(h),rt(h,i,a),Ce(t,h.prev,h.next),Ce(t,h,y===null?t.effect.first:y.next),Ce(t,y,h),y=h;continue}for(m=[],w=[];i!==null&&i!==h;)(S??(S=new Set)).add(i),w.push(i),i=tt(i.next);if(i===null)continue}(h.f&Ie)===0&&m.push(h),y=h,i=tt(h.next)}if(t.outrogroups!==null){for(const te of t.outrogroups)te.pending.size===0&&(zt(Xt(te.done)),(V=t.outrogroups)==null||V.delete(te));t.outrogroups.size===0&&(t.outrogroups=null)}if(i!==null||S!==void 0){var C=[];if(S!==void 0)for(h of S)(h.f&Rt)===0&&C.push(h);for(;i!==null;)(i.f&Rt)===0&&i!==t.fallback&&C.push(i),i=tt(i.next);var q=C.length;if(q>0){var E=(s&Ma)!==0&&l===0?a:null;if(n){for(N=0;N<q;N+=1)(ie=(Z=C[N].nodes)==null?void 0:Z.a)==null||ie.measure();for(N=0;N<q;N+=1)(re=(fe=C[N].nodes)==null?void 0:fe.a)==null||re.fix()}Dr(t,C,E)}}n&&Oa(()=>{var te,ve;if(L!==void 0)for(h of L)(ve=(te=h.nodes)==null?void 0:te.a)==null||ve.apply()})}function Wr(t,r,a,s,u,n,l,d){var i=(l&gr)!==0?(l&br)===0?U(a,!1,!1):ya(a):null,S=(l&hr)!==0?ya(u):null;return{v:i,i:S,e:Bt(()=>(n(r,i??a,S??u,d),()=>{t.delete(s)}))}}function rt(t,r,a){if(t.nodes)for(var s=t.nodes.start,u=t.nodes.end,n=r&&(r.f&Ie)===0?r.nodes.start:a;s!==null;){var l=Ft(s);if(n.before(s),s===u)return;s=l}}function Ce(t,r,a){r===null?t.effect.first=a:r.next=a,a===null?t.effect.last=r:a.prev=r}function Br(t,r){let a=null,s=le;var u;if(le){a=at;for(var n=Na(document.head);n!==null&&(n.nodeType!==Ca||n.data!==t);)n=Ft(n);if(n===null)ot(!1);else{var l=Ft(n);n.remove(),st(l)}}le||(u=document.head.appendChild(pt()));try{Ta(()=>r(u),Er|xr)}finally{s&&(ot(!0),st(a))}}function Ua(t){var r,a,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var u=t.length;for(r=0;r<u;r++)t[r]&&(a=Ua(t[r]))&&(s&&(s+=" "),s+=a)}else for(a in t)t[a]&&(s&&(s+=" "),s+=a);return s}function Fr(){for(var t,r,a=0,s="",u=arguments.length;a<u;a++)(t=arguments[a])&&(r=Ua(t))&&(s&&(s+=" "),s+=r);return s}function zr(t){return typeof t=="object"?Fr(t):t??""}const Ea=[...` 	
\r\f \v\uFEFF`];function Ur(t,r,a){var s=t==null?"":""+t;if(r&&(s=s?s+" "+r:r),a){for(var u of Object.keys(a))if(a[u])s=s?s+" "+u:u;else if(s.length)for(var n=u.length,l=0;(l=s.indexOf(u,l))>=0;){var d=l+n;(l===0||Ea.includes(s[l-1]))&&(d===s.length||Ea.includes(s[d]))?s=(l===0?"":s.substring(0,l))+s.substring(d+1):l=d}}return s===""?null:s}function Jr(t,r){return t==null?null:String(t)}function Re(t,r,a,s,u,n){var l=t.__className;if(le||l!==a||l===void 0){var d=Ur(a,s,n);(!le||d!==t.getAttribute("class"))&&(d==null?t.removeAttribute("class"):t.className=d),t.__className=a}else if(n&&u!==n)for(var i in n){var S=!!n[i];(u==null||S!==!!u[i])&&t.classList.toggle(i,S)}return n}function Hr(t,r,a,s){var u=t.__style;if(le||u!==r){var n=Jr(r);(!le||n!==t.getAttribute("style"))&&(n==null?t.removeAttribute("style"):t.style.cssText=n),t.__style=r}return s}function Qe(t,r,a=!1){if(t.multiple){if(r==null)return;if(!Qt(r))return $r();for(var s of t.options)s.selected=r.includes(lt(s));return}for(s of t.options){var u=lt(s);if(Ar(u,r)){s.selected=!0;return}}(!a||r!==void 0)&&(t.selectedIndex=-1)}function nt(t){var r=new MutationObserver(()=>{Qe(t,t.__value)});r.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),jr(()=>{r.disconnect()})}function Ut(t,r,a=r){var s=new WeakSet,u=!0;Da(t,"change",n=>{var l=n?"[selected]":":checked",d;if(t.multiple)d=[].map.call(t.querySelectorAll(l),lt);else{var i=t.querySelector(l)??t.querySelector("option:not([disabled])");d=i&&lt(i)}a(d),Ae!==null&&s.add(Ae)}),qa(()=>{var n=r();if(t===document.activeElement){var l=Wa??Ae;if(s.has(l))return}if(Qe(t,n,u),u&&n===void 0){var d=t.querySelector(":checked");d!==null&&(n=lt(d),a(n))}t.__value=n,u=!1}),nt(t)}function lt(t){return"__value"in t?t.__value:t.value}const Vr=Symbol("is custom element"),Gr=Symbol("is html"),Kr=Ba?"link":"LINK",Qr=Ba?"progress":"PROGRESS";function Oe(t){if(le){var r=!1,a=()=>{if(!r){if(r=!0,t.hasAttribute("value")){var s=t.value;se(t,"value",null),t.value=s}if(t.hasAttribute("checked")){var u=t.checked;se(t,"checked",null),t.checked=u}}};t.__on_r=a,Oa(a),Pr()}}function gt(t,r){var a=Yt(t);a.value===(a.value=r??void 0)||t.value===r&&(r!==0||t.nodeName!==Qr)||(t.value=r??"")}function bt(t,r){var a=Yt(t);a.checked!==(a.checked=r??void 0)&&(t.checked=r)}function se(t,r,a,s){var u=Yt(t);le&&(u[r]=t.getAttribute(r),r==="src"||r==="srcset"||r==="href"&&t.nodeName===Kr)||u[r]!==(u[r]=a)&&(r==="loading"&&(t[Tr]=a),a==null?t.removeAttribute(r):typeof a!="string"&&Xr(t).includes(r)?t[r]=a:t.setAttribute(r,a))}function Yt(t){return t.__attributes??(t.__attributes={[Vr]:t.nodeName.includes("-"),[Gr]:t.namespaceURI===Ir})}var xa=new Map;function Xr(t){var r=t.getAttribute("is")||t.nodeName,a=xa.get(r);if(a)return a;xa.set(r,a=[]);for(var s,u=t,n=Element.prototype;n!==u;){s=Nr(u);for(var l in s)s[l].set&&a.push(l);u=Mr(u)}return a}function Yr(t,r,a=r){var s=new WeakSet;Da(t,"input",async u=>{var n=u?t.defaultValue:t.value;if(n=Ot(t)?Dt(n):n,a(n),Ae!==null&&s.add(Ae),await Cr(),n!==(n=r())){var l=t.selectionStart,d=t.selectionEnd,i=t.value.length;if(t.value=n??"",d!==null){var S=t.value.length;l===d&&d===i&&S>i?(t.selectionStart=S,t.selectionEnd=S):(t.selectionStart=l,t.selectionEnd=Math.min(d,S))}}}),(le&&t.defaultValue!==t.value||b(r)==null&&t.value)&&(a(Ot(t)?Dt(t.value):t.value),Ae!==null&&s.add(Ae)),Lr(()=>{var u=r();if(t===document.activeElement){var n=Wa??Ae;if(s.has(n))return}Ot(t)&&u===Dt(t.value)||t.type==="date"&&!u&&!t.value||u!==t.value&&(t.value=u??"")})}function Ot(t){var r=t.type;return r==="number"||r==="range"}function Dt(t){return t===""?null:+t}function Zr(t){return function(...r){var a=r[0];return a.stopPropagation(),t==null?void 0:t.apply(this,r)}}function en(t){return function(...r){var a=r[0];return a.preventDefault(),t==null?void 0:t.apply(this,r)}}function tn(t,r){var n;var a=(n=t.$$events)==null?void 0:n[r.type],s=Qt(a)?a.slice():a==null?[]:[a];for(var u of s)u.call(this,r)}function Ja(t){return typeof t=="object"&&t!==null}function ja(t,r){if(!Array.isArray(t))throw new Error(`Invalid API response for ${r}: expected array`);return t}function Le(t,r){if(!Ja(t))throw new Error(`Invalid API response for ${r}: expected object`);return t}function an(t,r,a){const s=Ja(a)&&a.detail!==void 0?String(a.detail):typeof a=="string"&&a.trim()?a.trim():`${t} ${r}`;return new Error(s)}async function ne(t,r={},a={}){const s=Number(a.timeoutMs||15e3),u=new AbortController,n=a.signal??r.signal;let l=null,d=null;n&&(n.aborted?u.abort(n.reason):(l=()=>u.abort(n.reason),n.addEventListener("abort",l,{once:!0}))),Number.isFinite(s)&&s>0&&(d=setTimeout(()=>u.abort(new Error("timeout")),s));try{const i=await fetch(t,{...r,signal:u.signal,headers:{Accept:"application/json",...r.headers||{}}}),S=await i.text();let y={};try{y=S?JSON.parse(S):{}}catch{y=S}if(!i.ok)throw an(i.status,i.statusText,y);return y}catch(i){throw u.signal.aborted?n&&n.aborted?i:new Error(`Request timed out after ${s}ms`):i instanceof Error?i:new Error(String(i))}finally{d!==null&&clearTimeout(d),n&&l&&n.removeEventListener("abort",l)}}const ae={workflows:async(t={})=>{const r=await ne("/api/workflows",{},t);return ja(r,"/api/workflows")},resolutionPresets:async(t={})=>{const r=await ne("/api/resolution-presets",{},t),a=Le(r,"/api/resolution-presets");if(!Array.isArray(a.presets))throw new Error("Invalid API response for /api/resolution-presets: expected presets[]");return{presets:a.presets}},defaultInputDir:async(t={})=>{const r=await ne("/api/input-dirs/default",{},t),a=Le(r,"/api/input-dirs/default");if(typeof a.default_path!="string"||typeof a.exists!="boolean")throw new Error("Invalid API response for /api/input-dirs/default");return{default_path:a.default_path,exists:a.exists}},normalizeInputDir:async(t,r={})=>{const a=await ne("/api/input-dirs/normalize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t})},r),s=Le(a,"/api/input-dirs/normalize");if(typeof s.normalized_path!="string")throw new Error("Invalid API response for /api/input-dirs/normalize");return s},health:async(t={})=>{const r=await ne("/api/health",{},t),a=Le(r,"/api/health");if(!("comfy"in a)||!("worker"in a)||!("pending"in a)||!("running"in a))throw new Error("Invalid API response for /api/health: missing required keys");return{comfy:!!a.comfy,worker:String(a.worker??""),pending:Number(a.pending??0),running:Number(a.running??0)}},jobs:async(t={})=>{const r=await ne("/api/jobs",{},t);return ja(r,"/api/jobs")},jobDetail:async(t,r={})=>{const a=await ne(`/api/jobs/${t}`,{},r),s=Le(a,`/api/jobs/${t}`);if(!Array.isArray(s.prompts))throw new Error(`Invalid API response for /api/jobs/${t}: missing prompts[]`);return{job:Le(s.job,`/api/jobs/${t}.job`),prompts:s.prompts}},jobLog:async(t,r={})=>{const a=Number(r.timeoutMs||15e3),s=new AbortController,u=r.signal;let n=null,l=null;u&&(u.aborted?s.abort():(l=()=>s.abort(),u.addEventListener("abort",l,{once:!0}))),n=setTimeout(()=>s.abort(),a);try{const d=await fetch(`/api/jobs/${t}/log`,{signal:s.signal});if(!d.ok)throw new Error(`${d.status} ${d.statusText}`);return d.text()}finally{n!==null&&clearTimeout(n),u&&l&&u.removeEventListener("abort",l)}},submitJob:(t,r={})=>ne("/api/jobs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},r),pause:(t={})=>ne("/api/queue/pause",{method:"POST"},t),resume:(t={})=>ne("/api/queue/resume",{method:"POST"},t),clearQueue:(t={})=>ne("/api/queue/clear",{method:"POST"},t),cancelJob:(t,r={})=>ne(`/api/jobs/${t}/cancel`,{method:"POST"},r),retryJob:(t,r={})=>ne(`/api/jobs/${t}/retry`,{method:"POST"},r),reloadWorkflows:(t={})=>ne("/api/reload/workflows",{method:"POST"},t),reloadLoras:(t={})=>ne("/api/reload/loras",{method:"POST"},t),promptPresets:async(t,r={})=>{const a=await ne(`/api/prompt-presets?mode=${encodeURIComponent(t)}`,{},r),s=Le(a,"/api/prompt-presets");if(!Array.isArray(s.items))throw new Error("Invalid API response for /api/prompt-presets: items[]");return s},savePromptPreset:(t,r={})=>ne("/api/prompt-presets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},r),settingsPresets:async(t={})=>{const r=await ne("/api/settings-presets",{},t),a=Le(r,"/api/settings-presets");if(!Array.isArray(a.items))throw new Error("Invalid API response for /api/settings-presets: items[]");return a},saveSettingsPreset:(t,r={})=>ne("/api/settings-presets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},r),uploadInputImage:async(t,r,a={})=>{const s=await t.arrayBuffer();return ne("/api/upload/input-image",{method:"POST",headers:{"x-filename":t.name,"x-subdir":r},body:s},a)}},Ha=De(null),Jt=De(""),Ht=3e3,rn=2e4,nn=12e3;let _t=null,Ue=!1,ft=0,ht=Ht,qt=0,Xe=null,wt=!1;function Zt(){_t!==null&&(clearTimeout(_t),_t=null)}function ea(){Xe&&(Xe.abort(),Xe=null)}function sn(){return ft<=0?ht:Math.min(ht*Math.pow(2,Math.min(ft,6)),rn)}function ta(t){Ue&&(Zt(),!(typeof document<"u"&&document.hidden)&&(_t=setTimeout(()=>{Va(!1)},Math.max(100,Number(t||ht)))))}async function Va(t){if(!Ue&&!t)return;const r=++qt;ea();const a=new AbortController;Xe=a;try{const s=await ae.health({signal:a.signal,timeoutMs:nn});if(r!==qt)return;Ha.set(s),Jt.set(""),ft=0}catch(s){if(r!==qt||!Ue&&a.signal.aborted)return;ft+=1,Jt.set(s instanceof Error?s.message:String(s))}finally{Xe===a&&(Xe=null),Ue&&ta(sn())}}function Ga(){if(Ue){if(document.hidden){Zt(),ea();return}ta(50)}}async function $a(){await Va(!0)}function on(t=Ht){Ka(),Ue=!0,ht=Math.max(800,Number(t||Ht)),ft=0,typeof document<"u"&&!wt&&(document.addEventListener("visibilitychange",Ga),wt=!0),ta(10)}function Ka(){Ue=!1,Zt(),ea(),typeof document<"u"&&wt&&(document.removeEventListener("visibilitychange",Ga),wt=!1)}const Qa=De([]),Vt=De(""),Gt=2500,ln=15e3,un=12e3;let mt=null,Je=!1,dt=0,yt=Gt,Wt=0,Ye=null,kt=!1;function aa(){mt!==null&&(clearTimeout(mt),mt=null)}function ra(){Ye&&(Ye.abort(),Ye=null)}function cn(){return dt<=0?yt:Math.min(yt*Math.pow(2,Math.min(dt,6)),ln)}function na(t){Je&&(aa(),!(typeof document<"u"&&document.hidden)&&(mt=setTimeout(()=>{Xa(!1)},Math.max(80,Number(t||yt)))))}async function Xa(t){if(!Je&&!t)return;const r=++Wt;ra();const a=new AbortController;Ye=a;try{const s=await ae.jobs({signal:a.signal,timeoutMs:un});if(r!==Wt)return;Qa.set(s),Vt.set(""),dt=0}catch(s){if(r!==Wt||!Je&&a.signal.aborted)return;dt+=1,Vt.set(s instanceof Error?s.message:String(s))}finally{Ye===a&&(Ye=null),Je&&na(cn())}}function Ya(){if(Je){if(document.hidden){aa(),ra();return}na(50)}}async function Ze(){await Xa(!0)}function fn(t=Gt){Za(),Je=!0,yt=Math.max(500,Number(t||Gt)),dt=0,typeof document<"u"&&!kt&&(document.addEventListener("visibilitychange",Ya),kt=!0),na(10)}function Za(){Je=!1,aa(),ra(),typeof document<"u"&&kt&&(document.removeEventListener("visibilitychange",Ya),kt=!1)}const er=De([]),dn=De({}),Aa=De("");async function tr(){try{const t=await ae.workflows();er.set(t),dn.set(Object.fromEntries(t.map(r=>[r.name,r]))),Aa.set("")}catch(t){Aa.set(t instanceof Error?t.message:String(t))}}var vn=F("Comfy: <strong> </strong> | Worker: <strong> </strong> ",1),pn=F('<span class="msg svelte-1piydef"> </span>'),_n=F('<section class="panel p-3" id="health" aria-live="polite"><div class="flex flex-wrap items-center gap-2 text-sm"><div class="grow"><!></div> <button id="pauseBtn" class="btn svelte-1piydef">Pause</button> <button id="resumeBtn" class="btn svelte-1piydef">Resume</button> <button id="reloadWfBtn" class="btn svelte-1piydef">Reload Workflows</button> <button id="reloadLoraBtn" class="btn svelte-1piydef">Reload LoRAs</button> <!></div></section>');function mn(t,r){ge(r,!1);const a=()=>He(Ha,"$health",u),s=()=>He(Jt,"$healthError",u),[u,n]=St();let l=U(""),d=U(!1);async function i(){if(!e(d)){v(d,!0),v(l,"");try{await ae.pause({timeoutMs:12e3}),await $a(),v(l,"Worker paused.")}catch(E){v(l,E instanceof Error?E.message:String(E))}finally{v(d,!1)}}}async function S(){if(!e(d)){v(d,!0),v(l,"");try{await ae.resume({timeoutMs:12e3}),await $a(),v(l,"Worker resumed.")}catch(E){v(l,E instanceof Error?E.message:String(E))}finally{v(d,!1)}}}async function y(){if(!e(d)){v(d,!0),v(l,"");try{await ae.reloadWorkflows({timeoutMs:2e4}),await tr(),await Ze(),v(l,"Workflows reloaded.")}catch(E){v(l,E instanceof Error?E.message:String(E))}finally{v(d,!1)}}}async function L(){if(!e(d)){v(d,!0),v(l,"");try{await ae.reloadLoras({timeoutMs:2e4}),v(l,"LoRAs reloaded.")}catch(E){v(l,E instanceof Error?E.message:String(E))}finally{v(d,!1)}}}me();var m=_n(),w=g(m),I=g(w),A=g(I);{var h=E=>{var k=vn(),$=p(je(k)),Q=g($,!0);_($);var z=p($,2),V=g(z,!0);_(z);var Z=p(z);H(()=>{Re($,1,zr(a().comfy?"text-emerald-300":"text-rose-300")),W(Q,a().comfy?"up":"down"),W(V,a().worker),W(Z,` | Pending: ${a().pending??""}
        | Running: ${a().running??""}`)}),R(E,k)},N=E=>{var k=ba();H(()=>W(k,`Health error: ${s()??""}`)),R(E,k)},J=E=>{var k=ba("Loading health...");R(E,k)};oe(A,E=>{a()?E(h):s()?E(N,1):E(J,!1)})}_(I);var T=p(I,2),x=p(T,2),O=p(x,2),j=p(O,2),C=p(j,2);{var q=E=>{var k=pn(),$=g(k,!0);_(k),H(()=>W($,e(l))),R(E,k)};oe(C,E=>{e(l)&&E(q)})}_(w),_(m),H(()=>{T.disabled=e(d),x.disabled=e(d),O.disabled=e(d),j.disabled=e(d)}),D("click",T,i),D("click",x,S),D("click",O,y),D("click",j,L),R(t,m),be(),n()}var gn=F("<span> </span>");function bn(t,r){ge(r,!1);let a=ee(r,"status",8,"pending");const s=l=>`s-${String(l||"").toLowerCase()}`;me();var u=gn(),n=g(u,!0);_(u),H(l=>{Re(u,1,l,"svelte-jqgyoh"),W(n,a())},[()=>(Y(a()),b(()=>`badge ${s(a())}`))]),R(t,u),be()}var hn=F('<div class="row svelte-1eet90m"><div class="status svelte-1eet90m"><span> </span> <span> </span> <span class="st svelte-1eet90m"> </span></div> <div class="paths svelte-1eet90m"><div class="line svelte-1eet90m"><strong class="svelte-1eet90m">in</strong> </div> <div class="line svelte-1eet90m"><strong class="svelte-1eet90m">out</strong> </div></div> <div class="meta svelte-1eet90m"><span> </span> <span> </span></div></div>');function wn(t,r){ge(r,!1);let a=ee(r,"prompt",8);function s(C){const q=String(C||"").toLowerCase();return q==="succeeded"?"✅":q==="failed"?"❌":q==="running"?"⏳":q==="canceled"?"⛔":"⬚"}function u(C){return C==null||C===""?"n/a":String(C)}me();var n=hn(),l=g(n),d=g(l),i=g(d,!0);_(d);var S=p(d,2),y=g(S);_(S);var L=p(S,2),m=g(L,!0);_(L),_(l);var w=p(l,2),I=g(w),A=p(g(I));_(I);var h=p(I,2),N=p(g(h));_(h),_(w);var J=p(w,2),T=g(J),x=g(T);_(T);var O=p(T,2),j=g(O);_(O),_(J),_(n),H((C,q,E,k,$)=>{W(i,C),W(y,`#${Y(a()),b(()=>a().id)??""}`),W(m,(Y(a()),b(()=>a().status))),W(A,` ${q??""}`),W(N,` ${E??""}`),W(x,`seed: ${k??""}`),W(j,`pid: ${$??""}`)},[()=>(Y(a()),b(()=>s(a().status))),()=>(Y(a()),b(()=>u(a().input_file))),()=>(Y(a()),b(()=>u(a().output_paths))),()=>(Y(a()),b(()=>u(a().seed_used))),()=>(Y(a()),b(()=>u(a().prompt_id)))]),R(t,n),be()}var yn=F('<div class="meta-item svelte-1tfq0oe"><span class="k svelte-1tfq0oe"> </span> <span class="v svelte-1tfq0oe"> </span></div>'),kn=F('<div class="muted svelte-1tfq0oe">Loading log...</div>'),Sn=F('<div class="err svelte-1tfq0oe"> </div>'),En=F('<pre class="svelte-1tfq0oe"> </pre>'),xn=F('<div class="log-wrap svelte-1tfq0oe"><!></div>'),jn=F('<section class="detail svelte-1tfq0oe"><div class="meta-grid svelte-1tfq0oe"></div> <div class="head-row svelte-1tfq0oe"><strong> </strong> <button class="log-btn svelte-1tfq0oe"> </button></div> <div class="prompts svelte-1tfq0oe"></div> <!></section>');function $n(t,r){ge(r,!1);let a=ee(r,"detail",8,null),s=U(!1),u=U(!1),n=U(""),l=U("");function d(m){if(m==null||m==="")return"n/a";if(typeof m=="object")try{return JSON.stringify(m)}catch{return String(m)}return String(m)}async function i(){if(v(s,!e(s)),!(!e(s)||e(n)||e(u)||!a())){v(u,!0),v(l,"");try{v(n,await ae.jobLog(Number(a().job.id),{timeoutMs:15e3}))}catch(m){v(l,m instanceof Error?m.message:String(m))}finally{v(u,!1)}}}me();var S=ze(),y=je(S);{var L=m=>{var w=jn(),I=g(w);ke(I,5,()=>(Y(a()),b(()=>Object.entries(a().job))),ye,(C,q)=>{var E=ct(()=>Fa(e(q),2));let k=()=>e(E)[0],$=()=>e(E)[1];var Q=yn(),z=g(Q),V=g(z,!0);_(z);var Z=p(z,2),ie=g(Z,!0);_(Z),_(Q),H(fe=>{W(V,k()),W(ie,fe)},[()=>($(),b(()=>d($())))]),R(C,Q)}),_(I);var A=p(I,2),h=g(A),N=g(h);_(h);var J=p(h,2),T=g(J,!0);_(J),_(A);var x=p(A,2);ke(x,5,()=>(Y(a()),b(()=>a().prompts)),ye,(C,q)=>{wn(C,{get prompt(){return e(q)}})}),_(x);var O=p(x,2);{var j=C=>{var q=xn(),E=g(q);{var k=z=>{var V=kn();R(z,V)},$=z=>{var V=Sn(),Z=g(V,!0);_(V),H(()=>W(Z,e(l))),R(z,V)},Q=z=>{var V=En(),Z=g(V,!0);_(V),H(()=>W(Z,e(n)||"(empty log)")),R(z,V)};oe(E,z=>{e(u)?z(k):e(l)?z($,1):z(Q,!1)})}_(q),R(C,q)};oe(O,C=>{e(s)&&C(j)})}_(w),H(()=>{W(N,`Prompts (${Y(a()),b(()=>a().prompts.length)??""})`),W(T,e(s)?"Hide Log":"View Log")}),D("click",J,i),R(m,w)};oe(y,m=>{a()&&m(L)})}R(t,S),be()}var An=F('<button class="svelte-1ao9y7f">Retry</button>'),In=F('<button class="svelte-1ao9y7f">Cancel</button>'),Pn=F('<div class="err svelte-1ao9y7f"> </div>'),Tn=F('<div class="loading svelte-1ao9y7f">Loading details...</div>'),Mn=F('<div class="err svelte-1ao9y7f"> </div>'),Nn=F('<article class="job svelte-1ao9y7f"><div class="top svelte-1ao9y7f"><button class="exp svelte-1ao9y7f"> </button> <strong> </strong> <span class="name svelte-1ao9y7f"> </span> <span class="workflow svelte-1ao9y7f"> </span> <!> <div class="actions svelte-1ao9y7f"><!> <!></div></div> <div class="sub svelte-1ao9y7f"><span> </span> <div class="bar svelte-1ao9y7f"><div class="fill svelte-1ao9y7f"></div></div> <span> </span> <span> </span> <span> </span></div> <!> <!></article>');function Cn(t,r){ge(r,!1);let a=ee(r,"job",8),s=U(!1),u=U(!1),n=U(""),l=U(null),d=U(!1),i=U("");function S(){return Number(a().succeeded_count||0)+Number(a().failed_count||0)+Number(a().canceled_count||0)}function y(){return Math.max(0,Number(a().prompt_count||0))}function L(){const P=y();return P<=0?0:Math.min(100,Math.round(S()/P*100))}function m(P){if(!P)return"n/a";const M=new Date(String(P)).getTime();if(!Number.isFinite(M))return"n/a";const X=Math.max(0,Math.floor((Date.now()-M)/1e3));return X<60?`${X}s ago`:X<3600?`${Math.floor(X/60)}m ago`:X<86400?`${Math.floor(X/3600)}h ago`:`${Math.floor(X/86400)}d ago`}async function w(){if(v(s,!e(s)),!(!e(s)||e(l)||e(u))){v(u,!0),v(n,"");try{v(l,await ae.jobDetail(Number(a().id),{timeoutMs:15e3}))}catch(P){v(n,P instanceof Error?P.message:String(P))}finally{v(u,!1)}}}async function I(P){if(P.stopPropagation(),!e(d)&&window.confirm(`Cancel job #${a().id}?`)){v(d,!0),v(i,"");try{await ae.cancelJob(Number(a().id),{timeoutMs:12e3}),await Ze()}catch(M){v(i,M instanceof Error?M.message:String(M))}finally{v(d,!1)}}}async function A(P){if(P.stopPropagation(),!e(d)){v(d,!0),v(i,"");try{await ae.retryJob(Number(a().id),{timeoutMs:12e3}),await Ze()}catch(M){v(i,M instanceof Error?M.message:String(M))}finally{v(d,!1)}}}me();var h=Nn(),N=g(h),J=g(N),T=g(J,!0);_(J);var x=p(J,2),O=g(x);_(x);var j=p(x,2),C=g(j,!0);_(j);var q=p(j,2),E=g(q,!0);_(q);var k=p(q,2);{let P=it(()=>(Y(a()),b(()=>String(a().status||""))));bn(k,{get status(){return e(P)}})}var $=p(k,2),Q=g($);{var z=P=>{var M=An();H(()=>M.disabled=e(d)),D("click",M,A),R(P,M)},V=ct(()=>(Y(a()),b(()=>String(a().status||"").toLowerCase()==="failed")));oe(Q,P=>{e(V)&&P(z)})}var Z=p(Q,2);{var ie=P=>{var M=In();H(()=>M.disabled=e(d)),D("click",M,I),R(P,M)},fe=ct(()=>(Y(a()),b(()=>["pending","running"].includes(String(a().status||"").toLowerCase()))));oe(Z,P=>{e(fe)&&P(ie)})}_($),_(N);var re=p(N,2),te=g(re),ve=g(te);_(te);var he=p(te,2),$e=g(he);_(he);var Se=p(he,2),pe=g(Se);_(Se);var ue=p(Se,2),Ee=g(ue);_(ue);var We=p(ue,2),Ve=g(We);_(We),_(re);var Be=p(re,2);{var Fe=P=>{var M=Pn(),X=g(M,!0);_(M),H(()=>W(X,e(i))),R(P,M)};oe(Be,P=>{e(i)&&P(Fe)})}var K=p(Be,2);{var G=P=>{var M=ze(),X=je(M);{var we=_e=>{var Pe=Tn();R(_e,Pe)},Ge=_e=>{var Pe=Mn(),et=g(Pe,!0);_(Pe),H(()=>W(et,e(n))),R(_e,Pe)},Ke=_e=>{$n(_e,{get detail(){return e(l)}})};oe(X,_e=>{e(u)?_e(we):e(n)?_e(Ge,1):_e(Ke,!1)})}R(P,M)};oe(K,P=>{e(s)&&P(G)})}_(h),H((P,M,X,we,Ge,Ke)=>{se(J,"aria-label",e(s)?"Collapse job details":"Expand job details"),W(T,e(s)?"▾":"▸"),W(O,`#${Y(a()),b(()=>a().id)??""}`),W(C,(Y(a()),b(()=>a().name||"-"))),W(E,(Y(a()),b(()=>a().workflow_name||"-"))),W(ve,`${P??""} / ${M??""} prompts`),Hr($e,X),W(pe,`${we??""}%`),W(Ee,`created ${Ge??""}`),W(Ve,`started ${Ke??""}`)},[()=>b(S),()=>b(y),()=>b(()=>`width:${L()}%`),()=>b(L),()=>(Y(a()),b(()=>m(a().created_at))),()=>(Y(a()),b(()=>m(a().started_at)))]),D("click",J,Zr(w)),R(t,h),be()}var Ln=F('<div class="row svelte-146p8hb"><button id="cancelSelBtn" class="btn svelte-146p8hb">Cancel Selected</button> <button id="clearQueueBtn" class="btn svelte-146p8hb">Clear Queue</button> <span class="msg svelte-146p8hb"> </span></div>');function Rn(t,r){ge(r,!1);let a=ee(r,"selectedIds",24,()=>[]),s=U(""),u=U(!1);async function n(){if(!(!a().length||e(u))&&confirm(`Cancel ${a().length} selected jobs?`)){v(u,!0),v(s,"");try{const w=(await Promise.allSettled(a().map(I=>ae.cancelJob(I)))).filter(I=>I.status==="rejected").length;v(s,w>0?`Canceled ${a().length-w}, failed ${w}.`:`Canceled ${a().length} job(s).`),await Ze()}finally{v(u,!1)}}}async function l(){if(!e(u)&&confirm("Clear entire queue?")&&confirm("Confirm clear queue now.")){v(u,!0),v(s,"");try{await ae.clearQueue(),await Ze(),v(s,"Queue cleared.")}finally{v(u,!1)}}}me();var d=Ln(),i=g(d),S=p(i,2),y=p(S,2),L=g(y,!0);_(y),_(d),H(()=>{i.disabled=(e(u),Y(a()),b(()=>e(u)||!a().length)),S.disabled=e(u),W(L,e(s))}),D("click",i,n),D("click",S,l),R(t,d),be()}var On=F('<label class="sel svelte-3h4jzh"><input type="checkbox"/> <!></label>'),Dn=F('<button class="load-more svelte-3h4jzh"> </button>'),qn=F('<section class="panel p-3" id="queuePanel"><div class="head svelte-3h4jzh"><strong>Queue</strong> <span class="count svelte-3h4jzh"> </span> <span class="err svelte-3h4jzh"> </span></div> <div class="controls svelte-3h4jzh"><select id="statusFilter" class="svelte-3h4jzh"><option>All</option><option>Running</option><option>Failed</option><option>Pending</option><option>Succeeded</option><option>Canceled</option></select> <input id="queueSearch" placeholder="Search jobs..." class="svelte-3h4jzh"/> <select id="queueSort" class="svelte-3h4jzh"><option>Actionable</option><option>Newest</option><option>Oldest</option></select> <button id="selectVisible" type="button" class="svelte-3h4jzh">Select Visible</button> <button type="button" class="svelte-3h4jzh">Clear Selection</button></div> <div class="list svelte-3h4jzh" id="jobList"><!> <!></div> <!></section>');function Wn(t,r){ge(r,!1);const a=()=>He(h,"$visible",u),s=()=>He(Vt,"$jobsError",u),[u,n]=St(),l=U(),d=U(),i=200;let S=U(""),y=U("actionable"),L=U("all"),m=U([]),w=U(i),I=U("");function A(K){const G=String(K||"").toLowerCase();return G==="running"?0:G==="failed"?1:G==="pending"?2:G==="canceled"?3:G==="succeeded"?4:5}const h=cr(Qa,K=>{const G=e(S).toLowerCase().trim();let P=[...K];return e(L)!=="all"&&(P=P.filter(M=>String(M.status).toLowerCase()===e(L))),G&&(P=P.filter(M=>`${M.id} ${M.name||""} ${M.workflow_name||""} ${M.status||""} ${M.error_summary||""}`.toLowerCase().includes(G))),e(y)==="newest"?P.sort((M,X)=>X.id-M.id):e(y)==="oldest"?P.sort((M,X)=>M.id-X.id):P.sort((M,X)=>A(String(M.status))-A(String(X.status))||X.id-M.id),P});function N(K){const G=K.currentTarget;if(!G||e(w)>=e(l).length)return;G.scrollTop+G.clientHeight>=G.scrollHeight-280&&v(w,Math.min(e(l).length,e(w)+i))}function J(K,G){const P=Number(K);if(G){e(m).includes(P)||v(m,[...e(m),P]);return}v(m,e(m).filter(M=>M!==P))}function T(){v(m,e(d).map(K=>Number(K.id)))}function x(){v(m,[])}ce(()=>a(),()=>{v(l,a())}),ce(()=>(e(L),e(y),e(S),e(I)),()=>{const K=`${e(L)}|${e(y)}|${e(S)}`;K!==e(I)&&(v(I,K),v(w,i),v(m,[]))}),ce(()=>(e(l),e(w)),()=>{v(d,e(l).slice(0,e(w)))}),za(),me();var O=qn(),j=g(O),C=p(g(j),2),q=g(C);_(C);var E=p(C,2),k=g(E,!0);_(E),_(j);var $=p(j,2),Q=g($),z=g(Q);z.value=z.__value="all";var V=p(z);V.value=V.__value="running";var Z=p(V);Z.value=Z.__value="failed";var ie=p(Z);ie.value=ie.__value="pending";var fe=p(ie);fe.value=fe.__value="succeeded";var re=p(fe);re.value=re.__value="canceled",_(Q);var te=p(Q,2);Oe(te);var ve=p(te,2),he=g(ve);he.value=he.__value="actionable";var $e=p(he);$e.value=$e.__value="newest";var Se=p($e);Se.value=Se.__value="oldest",_(ve);var pe=p(ve,2),ue=p(pe,2);_($);var Ee=p($,2),We=g(Ee);ke(We,1,()=>e(d),ye,(K,G)=>{var P=On(),M=g(P);Oe(M);var X=p(M,2);Cn(X,{get job(){return e(G)}}),_(P),H(we=>bt(M,we),[()=>(e(m),e(G),b(()=>e(m).includes(Number(e(G).id))))]),D("change",M,we=>{J(Number(e(G).id),we.target.checked)}),R(K,P)});var Ve=p(We,2);{var Be=K=>{var G=Dn(),P=g(G);_(G),H(()=>W(P,`Load More (${e(l),e(d),b(()=>e(l).length-e(d).length)??""} remaining)`)),D("click",G,()=>{v(w,Math.min(e(l).length,e(w)+i))}),R(K,G)};oe(Ve,K=>{e(d),e(l),b(()=>e(d).length<e(l).length)&&K(Be)})}_(Ee);var Fe=p(Ee,2);Rn(Fe,{get selectedIds(){return e(m)}}),_(O),H(()=>{W(q,`${e(d),b(()=>e(d).length)??""} of ${e(l),b(()=>e(l).length)??""}`),W(k,s()),ue.disabled=(e(m),b(()=>!e(m).length))}),Ut(Q,()=>e(L),K=>v(L,K)),Yr(te,()=>e(S),K=>v(S,K)),Ut(ve,()=>e(y),K=>v(y,K)),D("click",pe,T),D("click",ue,x),D("scroll",Ee,N),R(t,O),be(),n()}var Bn=F('<span class="hint svelte-h9j4cw">No files selected</span>'),Fn=F('<img class="thumb svelte-h9j4cw" alt="preview"/>'),zn=F('<div class="pill svelte-h9j4cw"> </div>'),Un=F('<div role="button" tabindex="0"><div class="title svelte-h9j4cw"> </div> <button class="browse svelte-h9j4cw" type="button">Browse…</button> <input type="file" multiple="" class="svelte-h9j4cw"/> <div class="thumbs svelte-h9j4cw"><!></div></div>');function Jn(t,r){ge(r,!1);let a=ee(r,"visible",8,!0),s=ee(r,"label",8,"Drop images here"),u=ee(r,"id",8,"dropZone"),n=ee(r,"inputId",8,"fileInput"),l=ee(r,"thumbsId",8,"thumbs"),d=ee(r,"thumbnails",24,()=>[]),i=ee(r,"accept",8,".png,.jpg,.jpeg,.webp,.bmp"),S=ee(r,"disabled",8,!1);const y=Kt();function L(T){const x=i().split(",").map(j=>j.trim().toLowerCase()).filter(Boolean);if(!x.length)return!0;const O=T.name.toLowerCase();return x.some(j=>j.startsWith(".")?O.endsWith(j):!0)}function m(T){const x=T.filter(O=>L(O));x.length&&y("files",x)}function w(T){var O;if(T.preventDefault(),S())return;const x=Array.from(((O=T.dataTransfer)==null?void 0:O.files)||[]);m(x)}function I(T){if(S())return;const x=T.target,O=Array.from(x.files||[]);m(O),x.value=""}function A(){if(S())return;const T=document.getElementById(n());T==null||T.click()}me();var h=ze(),N=je(h);{var J=T=>{var x=Un();let O;var j=g(x),C=g(j,!0);_(j);var q=p(j,2),E=p(q,2),k=p(E,2),$=g(k);{var Q=V=>{var Z=Bn();R(V,Z)},z=V=>{var Z=ze(),ie=je(Z);ke(ie,1,d,ye,(fe,re)=>{var te=ze(),ve=je(te);{var he=pe=>{var ue=Fn();H(()=>se(ue,"src",e(re))),R(pe,ue)},$e=ct(()=>(e(re),b(()=>e(re).startsWith("blob:")||e(re).startsWith("data:")||e(re).startsWith("http")||e(re).startsWith("/")))),Se=pe=>{var ue=zn(),Ee=g(ue,!0);_(ue),H(()=>W(Ee,e(re))),R(pe,ue)};oe(ve,pe=>{e($e)?pe(he):pe(Se,!1)})}R(fe,te)}),R(V,Z)};oe($,V=>{Y(d()),b(()=>!d().length)?V(Q):V(z,!1)})}_(k),_(x),H(()=>{O=Re(x,1,"dz svelte-h9j4cw",null,O,{disabled:S()}),se(x,"id",u()),W(C,s()),q.disabled=S(),se(E,"id",n()),se(E,"accept",i()),se(k,"id",l())}),D("click",q,A),D("change",E,I),D("dragover",x,en(function(V){tn.call(this,r,V)})),D("drop",x,w),R(T,x)};oe(N,T=>{a()&&T(J)})}R(t,h),be()}var Hn=F('<input type="checkbox" class="svelte-1xcyq4x"/>'),Vn=F('<input type="number" class="svelte-1xcyq4x"/>'),Gn=F('<textarea rows="2" class="svelte-1xcyq4x"></textarea>'),Kn=F('<label class="field svelte-1xcyq4x"><span> <span class="n svelte-1xcyq4x"> </span></span> <!></label>'),Qn=F('<div class="grid svelte-1xcyq4x"></div>');function Xn(t,r){ge(r,!1);let a=ee(r,"id",8,"paramFields"),s=ee(r,"params",24,()=>({})),u=ee(r,"values",24,()=>({})),n=ee(r,"disabled",8,!1);const l=Kt();function d(L,m){const w=m?Number.parseFloat(L):Number.parseInt(L,10);return Number.isFinite(w)?w:null}function i(L,m,w){if(n())return;const I=w.target;let A;m.type==="bool"?A=w.target.checked:m.type==="int"?A=d(I.value,!1):m.type==="float"?A=d(I.value,!0):A=I.value,l("change",{name:L,value:A})}function S(L,m){const w=u()[L];return w==null?m.default===void 0||m.default===null?"":String(m.default):String(w)}me();var y=Qn();ke(y,5,()=>(Y(s()),b(()=>Object.entries(s()))),ye,(L,m)=>{var w=ct(()=>Fa(e(m),2));let I=()=>e(w)[0],A=()=>e(w)[1];var h=Kn(),N=g(h),J=g(N),T=p(J),x=g(T);_(T),_(N);var O=p(N,2);{var j=E=>{var k=Hn();Oe(k),H($=>{bt(k,$),k.disabled=n(),se(k,"data-param-name",I()),se(k,"data-param-type",(A(),b(()=>A().type)))},[()=>(Y(u()),I(),A(),b(()=>!!(u()[I()]??A().default)))]),D("change",k,$=>i(I(),A(),$)),R(E,k)},C=E=>{var k=Vn();Oe(k),H($=>{gt(k,$),se(k,"min",(A(),b(()=>A().min??void 0))),se(k,"max",(A(),b(()=>A().max??void 0))),se(k,"step",(A(),b(()=>A().type==="float"?"0.01":"1"))),k.disabled=n(),se(k,"data-param-name",I()),se(k,"data-param-type",(A(),b(()=>A().type)))},[()=>(I(),A(),b(()=>S(I(),A())))]),D("input",k,$=>i(I(),A(),$)),R(E,k)},q=E=>{var k=Gn();Rr(k),H($=>{gt(k,$),k.disabled=n(),se(k,"data-param-name",I()),se(k,"data-param-type",(A(),b(()=>A().type)))},[()=>(I(),A(),b(()=>S(I(),A())))]),D("input",k,$=>i(I(),A(),$)),R(E,k)};oe(O,E=>{A(),b(()=>A().type==="bool")?E(j):(A(),b(()=>A().type==="int"||A().type==="float")?E(C,1):E(q,!1))})}_(h),H(()=>{W(J,`${A(),b(()=>A().label)??""} `),W(x,`(${I()??""})`)}),R(L,h)}),_(y),H(()=>se(y,"id",a())),R(t,y),be()}var Yn=F("<option>(none)</option>"),Zn=F("<option> </option>"),es=F("<select><!><!></select>");function ts(t,r){ge(r,!1);let a=ee(r,"id",8,"resolutionSelect"),s=ee(r,"value",12,""),u=ee(r,"presets",24,()=>[]),n=ee(r,"disabled",8,!1);const l=Kt();function d(m){const w=m.target.value;s(w),l("change",w)}me();var i=es(),S=g(i);{var y=m=>{var w=Yn();w.value=w.__value="",R(m,w)};oe(S,m=>{Y(u()),b(()=>!u().length)&&m(y)})}var L=p(S);ke(L,1,u,ye,(m,w)=>{var I=Zn(),A=g(I,!0);_(I);var h={};H(()=>{W(A,(e(w),b(()=>e(w).label))),h!==(h=(e(w),b(()=>e(w).id)))&&(I.value=(I.__value=(e(w),b(()=>e(w).id)))??"")}),R(m,I)}),_(i),H(()=>{se(i,"id",a()),i.disabled=n()}),Ut(i,s),D("change",i,d),R(t,i),be()}const ar="video_queue_ui_v2_state";function ut(t){return{id:`ws-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,name:`Workspace ${t}`,active_tab:"batch",workflow_name:"",resolution_preset:"768x1360",flip_orientation:!1,move_processed:!1,input_dir:"",job_name:"",image_gen_source_mode:"t2i",params_by_workflow:{},dropped_input_dir:"",prompt_preset_name:"",settings_preset_name:""}}function as(t,r){const a=ut(r),s=t??{};return{...a,...s,id:typeof s.id=="string"&&s.id.trim()?s.id:a.id,name:typeof s.name=="string"&&s.name.trim()?s.name:a.name,active_tab:s.active_tab==="batch"||s.active_tab==="image_gen"||s.active_tab==="upscale"||s.active_tab==="upscale_images"?s.active_tab:a.active_tab,image_gen_source_mode:s.image_gen_source_mode==="i2i"?"i2i":"t2i",params_by_workflow:s.params_by_workflow&&typeof s.params_by_workflow=="object"?s.params_by_workflow:a.params_by_workflow,prompt_preset_name:typeof s.prompt_preset_name=="string"?s.prompt_preset_name:a.prompt_preset_name,settings_preset_name:typeof s.settings_preset_name=="string"?s.settings_preset_name:a.settings_preset_name}}function rs(){if(typeof window>"u")return{active_workspace_id:"",workspaces:[ut(1)]};try{const t=window.localStorage.getItem(ar);if(!t){const u=ut(1);return{active_workspace_id:u.id,workspaces:[u]}}const r=JSON.parse(t),a=Array.isArray(r==null?void 0:r.workspaces)?r.workspaces.map((u,n)=>as(u,n+1)):[];if(!a.length)throw new Error("bad");return{active_workspace_id:typeof(r==null?void 0:r.active_workspace_id)=="string"&&a.some(u=>u.id===r.active_workspace_id)?r.active_workspace_id:a[0].id,workspaces:a}}catch{const t=ut(1);return{active_workspace_id:t.id,workspaces:[t]}}}const qe=De(rs());qe.subscribe(t=>{if(!(typeof window>"u"))try{window.localStorage.setItem(ar,JSON.stringify(t))}catch{}});function ns(){qe.update(t=>{const r=ut(t.workspaces.length+1);return{active_workspace_id:r.id,workspaces:[...t.workspaces,r]}})}function ss(t,r){qe.update(a=>({...a,workspaces:a.workspaces.map(s=>s.id===t?{...s,name:r.trim()||s.name}:s)}))}function os(t){qe.update(r=>{if(r.workspaces.length<=1)return r;const a=r.workspaces.filter(u=>u.id!==t);return{active_workspace_id:r.active_workspace_id===t?a[Math.max(0,a.length-1)].id:r.active_workspace_id,workspaces:a}})}function is(t){qe.update(r=>({...r,active_workspace_id:t}))}function ls(t,r){qe.update(a=>({...a,workspaces:a.workspaces.map(s=>s.id===t?{...s,...r}:s)}))}var us=F("<option> </option>"),cs=F('<label for="imageGenSource">Image Gen source</label> <select id="imageGenSource" class="svelte-1h71fj3"><option>T2I</option><option>I2I</option></select>',1),fs=F("<option> </option>"),ds=F("<option> </option>"),vs=F('<section class="panel p-3" aria-label="Submit Panel"><div class="tabs svelte-1h71fj3" role="tablist" aria-label="Modes"><button id="modeBatch">Batch</button> <button id="modeImageGen">Image Gen</button> <button id="modeUpscale">Upscale Video</button> <button id="modeUpscaleImg">Upscale Image</button></div> <div class="shortcut-hint svelte-1h71fj3">Shortcuts: <code>Alt+1..4</code> switch mode, <code>Ctrl+Enter</code> submit.</div> <div class="grid2 svelte-1h71fj3"><div class="left svelte-1h71fj3"><div class="field-grid svelte-1h71fj3"><label for="workflowSelect">Workflow</label> <select id="workflowSelect" class="svelte-1h71fj3"></select> <label for="resolutionSelect">Resolution</label> <!> <!> <label for="inputDir">Input directory</label> <input id="inputDir" type="text" placeholder="/home/cobra/ComfyUI/input" class="svelte-1h71fj3"/> <label for="jobName">Job name</label> <input id="jobName" type="text" placeholder="optional" class="svelte-1h71fj3"/></div> <div class="checks svelte-1h71fj3"><label class="svelte-1h71fj3"><input id="flipOrientation" type="checkbox" class="svelte-1h71fj3"/> Flip orientation</label> <label class="svelte-1h71fj3"><input id="moveProcessed" type="checkbox" class="svelte-1h71fj3"/> Move processed to <code>_processed</code></label></div> <div class="preset-row svelte-1h71fj3"><label for="promptPresetSelect">Prompt preset</label> <select id="promptPresetSelect" class="svelte-1h71fj3"><option>(none)</option><!></select> <button class="svelte-1h71fj3">Save</button> <button class="svelte-1h71fj3">Apply</button></div> <div class="preset-row svelte-1h71fj3"><label for="settingsPresetSelect">Settings preset</label> <select id="settingsPresetSelect" class="svelte-1h71fj3"><option>(none)</option><!></select> <button class="svelte-1h71fj3">Save</button> <button class="svelte-1h71fj3">Apply</button></div> <div class="submit-row svelte-1h71fj3"><button id="submitBtn" class="primary svelte-1h71fj3">Submit</button> <button id="clearDropBtn" class="svelte-1h71fj3">Clear dropped set</button> <span id="submitMsg" class="svelte-1h71fj3"> </span></div></div> <div class="right svelte-1h71fj3"><!> <!></div></div></section>');function ps(t,r){ge(r,!1);const a=()=>He(qe,"$workspaceState",s),[s,u]=St(),n=U(),l=U(),d=U(),i=U(),S=U(),y=U(),L=U(),m=U(),w=U();let I=ee(r,"workflows",24,()=>[]),A=ee(r,"onSubmitted",8);const h={batch:"video_gen",image_gen:"image_gen",upscale:"video_upscale",upscale_images:"image_upscale"},N={batch:"video_gen",image_gen:"image_gen",upscale:"video_upscale",upscale_images:"image_upscale"},J=".png,.jpg,.jpeg,.webp,.bmp";let T=U([]),x=U([]),O=U([]),j=U(""),C=U(!1),q=U(!1),E=U([]),k=U("");function $(o){e(n)&&ls(e(n).id,o)}function Q(o){const c={};for(const[f,B]of Object.entries(o.parameters||{}))c[f]=B.default;return c}function z(o){$({active_tab:o,workflow_name:"",prompt_preset_name:""}),v(j,"")}function V(o){if(!e(n))return;const c=e(d).find(B=>B.name===o);if(!c)return;const f=e(n).params_by_workflow[c.name];$({workflow_name:c.name,params_by_workflow:f?e(n).params_by_workflow:{...e(n).params_by_workflow,[c.name]:Q(c)}})}function Z(o,c){if(!e(n)||!e(i))return;const f={...e(n).params_by_workflow};f[e(i).name]={...f[e(i).name]||{},[o]:c},$({params_by_workflow:f})}function ie(){for(const o of e(E))o.startsWith("blob:")&&URL.revokeObjectURL(o);v(E,[])}Ia(()=>{ie(),window.removeEventListener("keydown",Be)});async function fe(){v(q,!0);try{const[o,c]=await Promise.all([ae.resolutionPresets(),ae.settingsPresets()]);if(v(T,o.presets),v(O,c.items),e(n)&&!e(n).input_dir.trim()){const f=await ae.defaultInputDir();f.exists&&$({input_dir:f.default_path})}}catch(o){v(j,o instanceof Error?o.message:String(o))}finally{v(q,!1)}}Pa(()=>{fe(),window.addEventListener("keydown",Be)});async function re(o){try{const c=await ae.promptPresets(o);v(x,c.items)}catch(c){v(j,c instanceof Error?c.message:String(c))}}async function te(){try{const o=await ae.settingsPresets();v(O,o.items)}catch(o){v(j,o instanceof Error?o.message:String(o))}}async function ve(o){if(!o.length||!e(n))return;ie(),v(E,o.slice(0,16).map(B=>URL.createObjectURL(B)));const c=`uploads/v2/${e(n).id}/${Date.now()}`;let f="";try{for(const B of o)f=(await ae.uploadInputImage(B,c,{timeoutMs:3e4})).dir}catch(B){v(j,B instanceof Error?B.message:String(B));return}f&&($({input_dir:f,dropped_input_dir:f}),v(j,`Uploaded ${o.length} file(s) to ${f}`))}function he(){ie(),$({dropped_input_dir:""}),v(j,"Dropped file set cleared.")}function $e(o,c){if(o.type==="bool")return!!c;if(o.type==="int"||o.type==="float"){const f=typeof c=="number"?c:o.type==="float"?Number.parseFloat(String(c??"")):Number.parseInt(String(c??""),10);if(!Number.isFinite(f))return o.default;let B=f;return typeof o.min=="number"&&(B=Math.max(o.min,B)),typeof o.max=="number"&&(B=Math.min(o.max,B)),o.type==="int"?Math.trunc(B):B}return c==null?"":String(c)}function Se(o,c){const f={};for(const[B,de]of Object.entries(o.parameters||{}))f[B]=$e(de,c[B]);return f}async function pe(){if(!e(n)||!e(i))return;const o=window.prompt("Prompt preset name");if(!o||!o.trim())return;const c=String(e(S).positive_prompt??""),f=String(e(S).negative_prompt??"");try{await ae.savePromptPreset({name:o.trim(),mode:e(y),positive_prompt:c,negative_prompt:f}),await re(e(y)),$({prompt_preset_name:o.trim()}),v(j,`Saved prompt preset "${o.trim()}".`)}catch(B){v(j,B instanceof Error?B.message:String(B))}}function ue(){if(!e(n)||!e(i))return;const o=e(n).prompt_preset_name;if(!o){v(j,"Select a prompt preset first.");return}const c=e(x).find(B=>B.name===o);if(!c){v(j,`Prompt preset "${o}" not found.`);return}const f={...e(n).params_by_workflow};f[e(i).name]={...f[e(i).name]||{},positive_prompt:c.positive_prompt,negative_prompt:c.negative_prompt},$({params_by_workflow:f}),v(j,`Applied prompt preset "${c.name}".`)}async function Ee(){if(!e(n)||!e(i))return;const o=window.prompt("Settings preset name");if(!o||!o.trim())return;const c={active_tab:e(n).active_tab,workflow_name:e(i).name,resolution_preset:e(n).resolution_preset,flip_orientation:e(n).flip_orientation,move_processed:e(n).move_processed,input_dir:e(n).input_dir,image_gen_source_mode:e(n).image_gen_source_mode,params_by_workflow:e(n).params_by_workflow};try{await ae.saveSettingsPreset({name:o.trim(),payload:c}),await te(),$({settings_preset_name:o.trim()}),v(j,`Saved settings preset "${o.trim()}".`)}catch(f){v(j,f instanceof Error?f.message:String(f))}}function We(){if(!e(n))return;const o=e(O).find(B=>B.name===e(n).settings_preset_name);if(!o){v(j,"Select a settings preset first.");return}const c=o.payload||{},f={};(c.active_tab==="batch"||c.active_tab==="image_gen"||c.active_tab==="upscale"||c.active_tab==="upscale_images")&&(f.active_tab=c.active_tab),typeof c.workflow_name=="string"&&(f.workflow_name=c.workflow_name),typeof c.resolution_preset=="string"&&(f.resolution_preset=c.resolution_preset),typeof c.flip_orientation=="boolean"&&(f.flip_orientation=c.flip_orientation),typeof c.move_processed=="boolean"&&(f.move_processed=c.move_processed),typeof c.input_dir=="string"&&(f.input_dir=c.input_dir),(c.image_gen_source_mode==="t2i"||c.image_gen_source_mode==="i2i")&&(f.image_gen_source_mode=c.image_gen_source_mode),c.params_by_workflow&&typeof c.params_by_workflow=="object"&&(f.params_by_workflow=c.params_by_workflow),$(f),v(j,`Applied settings preset "${o.name}".`)}async function Ve(){if(!e(n)||!e(i)){v(j,"Choose a workflow first.");return}if(e(m)&&!e(w)){v(j,"This workflow requires input files. Set Input Dir or use upload.");return}const o={workflow_name:e(i).name,job_name:e(n).job_name.trim()||null,input_dir:e(i).input_type==="none"?"":e(w),params:Se(e(i),e(S)),resolution_preset:e(i).supports_resolution&&e(n).resolution_preset||null,flip_orientation:!!e(n).flip_orientation,move_processed:!!e(n).move_processed,split_by_input:!(e(l)==="image_gen"&&e(n).image_gen_source_mode==="t2i")};v(C,!0),v(j,"");try{const c=await ae.submitJob(o,{timeoutMs:45e3}),f=Number(c.job_count||(c.job_id?1:0)),B=Number(c.prompt_count||0);v(j,`Submitted ${f} job(s), ${B} prompt(s).`),await A()()}catch(c){v(j,c instanceof Error?c.message:String(c))}finally{v(C,!1)}}function Be(o){const c=o.target,f=!!c&&(c.tagName==="INPUT"||c.tagName==="TEXTAREA"||c.tagName==="SELECT"||c.getAttribute("contenteditable")==="true");if(o.altKey&&!o.ctrlKey&&!o.metaKey&&!o.shiftKey){o.key==="1"?(o.preventDefault(),z("batch")):o.key==="2"?(o.preventDefault(),z("image_gen")):o.key==="3"?(o.preventDefault(),z("upscale")):o.key==="4"&&(o.preventDefault(),z("upscale_images"));return}o.ctrlKey&&o.key==="Enter"&&(f||c===document.body)&&(o.preventDefault(),Ve())}ce(()=>a(),()=>{v(n,a().workspaces.find(o=>o.id===a().active_workspace_id)??a().workspaces[0]??null)}),ce(()=>e(n),()=>{var o;v(l,((o=e(n))==null?void 0:o.active_tab)??"batch")}),ce(()=>(Y(I()),e(l)),()=>{v(d,I().filter(o=>o.category===h[e(l)]))}),ce(()=>(e(d),e(n)),()=>{v(i,e(d).find(o=>{var c;return o.name===((c=e(n))==null?void 0:c.workflow_name)})??e(d)[0]??null)}),ce(()=>(e(n),e(i)),()=>{e(n)&&e(i)&&e(n).workflow_name!==e(i).name&&$({workflow_name:e(i).name})}),ce(()=>(e(n),e(i)),()=>{if(e(n)&&e(i)&&!e(n).params_by_workflow[e(i).name]){const c={...e(n).params_by_workflow,[e(i).name]:Q(e(i))};$({params_by_workflow:c})}}),ce(()=>(e(n),e(i)),()=>{v(S,(e(n)&&e(i)?e(n).params_by_workflow[e(i).name]:{})||{})}),ce(()=>e(l),()=>{v(y,N[e(l)])}),ce(()=>(e(y),e(k)),()=>{e(y)&&e(y)!==e(k)&&(v(k,e(y)),re(e(y)))}),ce(()=>(e(i),e(l),e(n)),()=>{var o;v(L,!!e(i)&&e(i).input_type==="image"&&!(e(l)==="image_gen"&&((o=e(n))==null?void 0:o.image_gen_source_mode)==="t2i"))}),ce(()=>(e(i),e(l),e(n)),()=>{var o;v(m,!!e(i)&&e(i).input_type!=="none"&&!(e(l)==="image_gen"&&((o=e(n))==null?void 0:o.image_gen_source_mode)==="t2i"))}),ce(()=>e(n),()=>{var o,c;v(w,(((o=e(n))==null?void 0:o.dropped_input_dir)||((c=e(n))==null?void 0:c.input_dir)||"").trim())}),za(),me();var Fe=vs(),K=g(Fe),G=g(K);let P;var M=p(G,2);let X;var we=p(M,2);let Ge;var Ke=p(we,2);let _e;_(K);var Pe=p(K,4),et=g(Pe),Et=g(et),Te=p(g(Et),2);ke(Te,5,()=>e(d),ye,(o,c)=>{var f=us(),B=g(f,!0);_(f);var de={};H(()=>{W(B,(e(c),b(()=>e(c).display_name))),de!==(de=(e(c),b(()=>e(c).name)))&&(f.value=(f.__value=(e(c),b(()=>e(c).name)))??"")}),R(o,f)}),_(Te);var sa;nt(Te);var oa=p(Te,4);{let o=it(()=>(e(n),b(()=>{var f;return((f=e(n))==null?void 0:f.resolution_preset)||""}))),c=it(()=>(e(q),e(i),b(()=>{var f;return e(q)||!((f=e(i))!=null&&f.supports_resolution)})));ts(oa,{id:"resolutionSelect",get value(){return e(o)},get presets(){return e(T)},get disabled(){return e(c)},$$events:{change:f=>$({resolution_preset:f.detail})}})}var ia=p(oa,2);{var rr=o=>{var c=cs(),f=p(je(c),2),B=g(f);B.value=B.__value="t2i";var de=p(B);de.value=de.__value="i2i",_(f);var ga;nt(f),H(()=>{ga!==(ga=(e(n),b(()=>{var xe;return((xe=e(n))==null?void 0:xe.image_gen_source_mode)||"t2i"})))&&(f.value=(f.__value=(e(n),b(()=>{var xe;return((xe=e(n))==null?void 0:xe.image_gen_source_mode)||"t2i"})))??"",Qe(f,(e(n),b(()=>{var xe;return((xe=e(n))==null?void 0:xe.image_gen_source_mode)||"t2i"}))))}),D("change",f,xe=>$({image_gen_source_mode:xe.target.value})),R(o,c)};oe(ia,o=>{e(l)==="image_gen"&&o(rr)})}var vt=p(ia,4);Oe(vt);var xt=p(vt,4);Oe(xt),_(Et);var jt=p(Et,2),$t=g(jt),At=g($t);Oe(At),ka(),_($t);var la=p($t,2),It=g(la);Oe(It),ka(2),_(la),_(jt);var Pt=p(jt,2),Me=p(g(Pt),2),Tt=g(Me);Tt.value=Tt.__value="";var nr=p(Tt);ke(nr,1,()=>e(x),ye,(o,c)=>{var f=fs(),B=g(f,!0);_(f);var de={};H(()=>{W(B,(e(c),b(()=>e(c).name))),de!==(de=(e(c),b(()=>e(c).name)))&&(f.value=(f.__value=(e(c),b(()=>e(c).name)))??"")}),R(o,f)}),_(Me);var ua;nt(Me);var ca=p(Me,2),sr=p(ca,2);_(Pt);var Mt=p(Pt,2),Ne=p(g(Mt),2),Nt=g(Ne);Nt.value=Nt.__value="";var or=p(Nt);ke(or,1,()=>e(O),ye,(o,c)=>{var f=ds(),B=g(f,!0);_(f);var de={};H(()=>{W(B,(e(c),b(()=>e(c).name))),de!==(de=(e(c),b(()=>e(c).name)))&&(f.value=(f.__value=(e(c),b(()=>e(c).name)))??"")}),R(o,f)}),_(Ne);var fa;nt(Ne);var da=p(Ne,2),ir=p(da,2);_(Mt);var va=p(Mt,2),Ct=g(va),Lt=p(Ct,2),pa=p(Lt,2),lr=g(pa,!0);_(pa),_(va),_(et);var _a=p(et,2),ma=g(_a);{let o=it(()=>(e(i),b(()=>{var c;return((c=e(i))==null?void 0:c.parameters)||{}})));Xn(ma,{id:"paramFields",get params(){return e(o)},get values(){return e(S)},get disabled(){return e(C)},$$events:{change:c=>Z(c.detail.name,c.detail.value)}})}var ur=p(ma,2);Jn(ur,{id:"dropZone",inputId:"fileInput",thumbsId:"thumbs",get visible(){return e(L)},label:"Drop image files for upload",get thumbnails(){return e(E)},accept:J,get disabled(){return e(C)},$$events:{files:o=>ve(o.detail)}}),_(_a),_(Pe),_(Fe),H((o,c)=>{P=Re(G,1,"svelte-1h71fj3",null,P,{active:e(l)==="batch"}),X=Re(M,1,"svelte-1h71fj3",null,X,{active:e(l)==="image_gen"}),Ge=Re(we,1,"svelte-1h71fj3",null,Ge,{active:e(l)==="upscale"}),_e=Re(Ke,1,"svelte-1h71fj3",null,_e,{active:e(l)==="upscale_images"}),sa!==(sa=(e(i),b(()=>{var f;return((f=e(i))==null?void 0:f.name)||""})))&&(Te.value=(Te.__value=(e(i),b(()=>{var f;return((f=e(i))==null?void 0:f.name)||""})))??"",Qe(Te,(e(i),b(()=>{var f;return((f=e(i))==null?void 0:f.name)||""})))),gt(vt,(e(n),b(()=>{var f;return((f=e(n))==null?void 0:f.input_dir)||""}))),gt(xt,(e(n),b(()=>{var f;return((f=e(n))==null?void 0:f.job_name)||""}))),bt(At,o),bt(It,c),ua!==(ua=(e(n),b(()=>{var f;return((f=e(n))==null?void 0:f.prompt_preset_name)||""})))&&(Me.value=(Me.__value=(e(n),b(()=>{var f;return((f=e(n))==null?void 0:f.prompt_preset_name)||""})))??"",Qe(Me,(e(n),b(()=>{var f;return((f=e(n))==null?void 0:f.prompt_preset_name)||""})))),fa!==(fa=(e(n),b(()=>{var f;return((f=e(n))==null?void 0:f.settings_preset_name)||""})))&&(Ne.value=(Ne.__value=(e(n),b(()=>{var f;return((f=e(n))==null?void 0:f.settings_preset_name)||""})))??"",Qe(Ne,(e(n),b(()=>{var f;return((f=e(n))==null?void 0:f.settings_preset_name)||""})))),Ct.disabled=e(C),Lt.disabled=(e(E),b(()=>!e(E).length)),W(lr,e(j))},[()=>(e(n),b(()=>{var o;return!!((o=e(n))!=null&&o.flip_orientation)})),()=>(e(n),b(()=>{var o;return!!((o=e(n))!=null&&o.move_processed)}))]),D("click",G,()=>z("batch")),D("click",M,()=>z("image_gen")),D("click",we,()=>z("upscale")),D("click",Ke,()=>z("upscale_images")),D("change",Te,o=>V(o.target.value)),D("input",vt,o=>$({input_dir:o.target.value})),D("input",xt,o=>$({job_name:o.target.value})),D("change",At,o=>$({flip_orientation:o.target.checked})),D("change",It,o=>$({move_processed:o.target.checked})),D("change",Me,o=>$({prompt_preset_name:o.target.value})),D("click",ca,pe),D("click",sr,ue),D("change",Ne,o=>$({settings_preset_name:o.target.value})),D("click",da,Ee),D("click",ir,We),D("click",Ct,Ve),D("click",Lt,he),R(t,Fe),be(),u()}var _s=F('<button role="tab"> </button>'),ms=F('<button id="renameWsBtn" class="svelte-1uha8ag">Rename</button> <button id="closeWsBtn" class="svelte-1uha8ag">Close</button>',1),gs=F('<main class="mx-auto grid max-w-6xl gap-3 p-4"><!> <section class="panel p-3" aria-label="Workspace Tabs"><div class="workspace-row svelte-1uha8ag"><div id="workspaceTabs" class="tabs svelte-1uha8ag" role="tablist" aria-label="Workspaces"></div> <div class="controls svelte-1uha8ag"><button id="newWsBtn" class="svelte-1uha8ag">New</button> <!></div></div></section> <!> <!></main>');function Es(t,r){ge(r,!1);const a=()=>He(qe,"$workspaceState",u),s=()=>He(er,"$workflows",u),[u,n]=St();Pa(async()=>{await tr(),on(),fn()}),Ia(()=>{Ka(),Za()});function l(J,T){const x=window.prompt("Workspace name",T);x!==null&&ss(J,x)}me();var d=gs();Br("1uha8ag",J=>{qa(()=>{Or.title="Video Queue UI V2"})});var i=g(d);mn(i,{});var S=p(i,2),y=g(S),L=g(y);ke(L,5,()=>a().workspaces,ye,(J,T)=>{var x=_s();let O;var j=g(x,!0);_(x),H(()=>{se(x,"aria-selected",e(T).id===a().active_workspace_id),O=Re(x,1,"svelte-1uha8ag",null,O,{active:e(T).id===a().active_workspace_id}),W(j,e(T).name)}),D("click",x,()=>is(e(T).id)),R(J,x)}),_(L);var m=p(L,2),w=g(m),I=p(w,2);{var A=J=>{var T=ze(),x=je(T);ke(x,1,()=>a().workspaces,ye,(O,j)=>{var C=ze(),q=je(C);{var E=k=>{var $=ms(),Q=je($),z=p(Q,2);H(()=>z.disabled=a().workspaces.length<=1),D("click",Q,()=>l(e(j).id,e(j).name)),D("click",z,()=>os(e(j).id)),R(k,$)};oe(q,k=>{e(j).id===a().active_workspace_id&&k(E)})}R(O,C)}),R(J,T)};oe(I,J=>{a().workspaces.length>0&&J(A)})}_(m),_(y),_(S);var h=p(S,2);ps(h,{get workflows(){return s()},get onSubmitted(){return Ze}});var N=p(h,2);Wn(N,{}),_(d),D("click",w,()=>ns()),R(t,d),be(),n()}export{Es as component};
